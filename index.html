<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TPAO Petroleum Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- CSS -->
  <link rel="stylesheet" href="index.css">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
</head>

<body>

<!-- Overlay -->
<div id="overlay"></div>

<!-- Menu Button -->
<button class="menu-btn" id="menuBtn">☰</button>

<!-- Sidebar -->
<aside class="sidebar" id="sidebar">
  <h2 class="logo">TPAO</h2>
  <nav>
    <a class="active" data-page="dashboard">Dashboard</a>
    <a data-page="production">Production</a>
    <a data-page="map">Oil Fields</a>
  </nav>
</aside>

<!-- Main -->
<main class="main">

  <!-- DASHBOARD -->
  <section id="dashboard" class="page active">

    <div class="banner">
      <img src="images/tpao-banner.jpg" alt="TPAO Operations">
      <div class="banner-text">
        <h1>TPAO Petroleum Dashboard</h1>
        <p>
          Türkiye Petrolleri Anonim Ortaklığı (TPAO) provides strategic leadership
          in oil and gas exploration, production, and energy security.
        </p>
      </div>
    </div>

    <div class="cards">
      <div class="card">
        <img src="images/oil-field.jpg" alt="Oil Field">
        <h3>Daily Production</h3>
        <p class="value">1.45M bbl</p>
        <p class="card-desc">Average daily crude oil production.</p>
      </div>

      <div class="card">
        <img src="images/refinery.jpg" alt="Refinery">
        <h3>Active Fields</h3>
        <p class="value">37</p>
        <p class="card-desc">Operational oil and gas fields.</p>
      </div>

      <div class="card">
        <img src="images/offshore.jpg" alt="Offshore">
        <h3>Countries</h3>
        <p class="value">6</p>
        <p class="card-desc">Countries of operation.</p>
      </div>

      <div class="card">
        <img src="images/oil-field.jpg" alt="Revenue">
        <h3>Revenue</h3>
        <p class="value">$18.2B</p>
        <p class="card-desc">Annual petroleum revenue.</p>
      </div>
    </div>
  </section>

  <!-- PRODUCTION -->
  <section id="production" class="page">
    <h1>Oil Production</h1>
    <p>Monthly crude oil production.</p>
    <canvas id="productionChart"></canvas>
  </section>

  <!-- MAP -->
  <section id="mapPage" class="page">
    <h1>TPAO Oil Fields</h1>
    <p>Interactive oil field locations.</p>
    <div id="map"></div>
  </section>

</main>

<script>
document.addEventListener('DOMContentLoaded', () => {

  const sidebar = document.getElementById('sidebar');
  const overlay = document.getElementById('overlay');
  const menuBtn = document.getElementById('menuBtn');
  let currentPage = 'dashboard';
  let mapLoaded = false;
  let mapInstance = null;

  /* ===== SIDEBAR ===== */
  function openSidebar() {
    sidebar.classList.add('show');
    overlay.classList.add('show');
  }

  function closeSidebar() {
    sidebar.classList.remove('show');
    overlay.classList.remove('show');
  }

  menuBtn.onclick = () => {
    sidebar.classList.contains('show') ? closeSidebar() : openSidebar();
  };

  overlay.onclick = closeSidebar;

  /* ===== NAVIGATION ===== */
  document.querySelectorAll('.sidebar a').forEach(link => {
    link.onclick = () => {
      navigate(link.dataset.page);
    };
  });

  function navigate(page) {
    currentPage = page;
    showPage(page);
    closeSidebar();
    history.pushState({ page }, '', `#${page}`);
  }

  function showPage(page) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.querySelectorAll('.sidebar a').forEach(a => a.classList.remove('active'));

    if (page === 'map') {
      document.getElementById('mapPage').classList.add('active');
      setTimeout(initMap, 300);
    } else {
      document.getElementById(page).classList.add('active');
    }

    document.querySelector(`.sidebar a[data-page="${page}"]`)?.classList.add('active');
  }

  /* ===== BACK BUTTON ===== */
  window.onpopstate = e => {
    if (!e.state) return;
    showPage(e.state.page);
  };

  /* ===== CHART ===== */
  new Chart(document.getElementById('productionChart'), {
    type: 'line',
    data: {
      labels: ['Jan','Feb','Mar','Apr','May','Jun'],
      datasets: [{
        label: 'Barrels / Day',
        data: [120,135,140,150,145,160],
        borderColor: '#22c55e',
        tension: 0.4
      }]
    }
  });

  /* ===== MAP ===== */
  function initMap() {
    if (mapLoaded) return;
    mapLoaded = true;

    mapInstance = L.map('map').setView([39, 35], 5);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(mapInstance);

    L.marker([37.88, 41.13]).addTo(mapInstance).bindPopup("Batman Oil Field");
    L.marker([40.4, 49.9]).addTo(mapInstance).bindPopup("Caspian Block");
  }

});
</script>

</body>
  </html>
